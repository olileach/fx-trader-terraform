{
  "version": 4,
  "terraform_version": "1.3.7",
  "serial": 1650,
  "lineage": "8b852c3f-d5d0-7b0c-74ff-5829d3c9f6c3",
  "outputs": {
    "lake_formation_account_id": {
      "value": "565692740138",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "data",
      "type": "archive_file",
      "name": "lambda_fx_trader_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "excludes": null,
            "id": "31e6b2557e67e5c46b1356c0c6bb90b2962404ff",
            "output_base64sha256": "bNBOiDjVhvPrbWhq40PLP3bKc7P7or78/LfG2VEE6DU=",
            "output_file_mode": null,
            "output_md5": "d8929c2ad6b5a8ac8421ab616f210ed1",
            "output_path": "modules/fx_trader/fx_trader_lambda.zip",
            "output_sha": "31e6b2557e67e5c46b1356c0c6bb90b2962404ff",
            "output_size": 49189087,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "modules/fx_trader/fx-trader/",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "data",
      "type": "aws_region",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "fx_trader_lambda_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::565692740138:policy/lambda-service-role/fx-trader-lambda-policy",
            "description": "IAM AWS Lambda policy needed for fx-trader demo.",
            "id": "arn:aws:iam::565692740138:policy/lambda-service-role/fx-trader-lambda-policy",
            "name": "fx-trader-lambda-policy",
            "name_prefix": "",
            "path": "/lambda-service-role/",
            "policy": "{\"Statement\":[{\"Action\":[\"kinesis:PutRecord\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:kinesis:us-east-1:565692740138:stream/*\"],\"Sid\":\"KinesesPermissions\"},{\"Action\":[\"ecr:BatchGetImage\",\"ecr:GetDownloadUrlForLayer\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"LambdaECRImageRetrievalPolicy\"},{\"Action\":\"sqs:SendMessage\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:sqs:*:*:*\",\"Sid\":\"SQSPermissions\"},{\"Action\":[\"xray:PutTraceSegments\",\"xray:PutTelemetryRecords\"],\"Effect\":\"Allow\",\"Resource\":\"*\",\"Sid\":\"LambdaXrayPermissions\"},{\"Action\":[\"logs:CreateLogStream\",\"logs:CreateLogGroup\",\"logs:GetLogEvents\",\"logs:FilterLogEvents\",\"logs:PutLogEvents\",\"logs:GetLogEvents\",\"logs:PutLogEvents\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:logs:*:*:log-group:*\",\"arn:aws:logs:*:*:log-group:*:*:*\"],\"Sid\":\"CWLPermissions\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAYHNPKGIVE3WQETGMG",
            "tags": null,
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.fx_trader.data.aws_caller_identity.current",
            "module.fx_trader.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_iam_policy_attachment",
      "name": "fx_trader_lamda_policy_attachment",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "groups": null,
            "id": "fx-trader-policy-attachment",
            "name": "fx-trader-policy-attachment",
            "policy_arn": "arn:aws:iam::565692740138:policy/lambda-service-role/fx-trader-lambda-policy",
            "roles": [
              "fx-trader-lambda-role"
            ],
            "users": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.fx_trader.aws_iam_policy.fx_trader_lambda_policy",
            "module.fx_trader.aws_iam_role.fx_trader_lambda_role",
            "module.fx_trader.data.aws_caller_identity.current",
            "module.fx_trader.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "fx_trader_lambda_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::565692740138:role/lambda-service-role/fx-trader-lambda-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2023-08-03T14:08:40Z",
            "description": "IAM lambda role to write to Kinesis",
            "force_detach_policies": false,
            "id": "fx-trader-lambda-role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "fx-trader-lambda-role",
            "name_prefix": "",
            "path": "/lambda-service-role/",
            "permissions_boundary": null,
            "role_last_used": [
              {
                "last_used_date": "",
                "region": ""
              }
            ],
            "tags": null,
            "tags_all": {},
            "unique_id": "AROAYHNPKGIVBOCPRM4QL"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_kinesis_stream",
      "name": "fx_trader_stream",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:kinesis:us-east-1:565692740138:stream/fx-trader",
            "encryption_type": "NONE",
            "enforce_consumer_deletion": false,
            "id": "arn:aws:kinesis:us-east-1:565692740138:stream/fx-trader",
            "kms_key_id": "",
            "name": "fx-trader",
            "retention_period": 48,
            "shard_count": 0,
            "shard_level_metrics": [
              "IncomingBytes",
              "OutgoingBytes"
            ],
            "stream_mode_details": [
              {
                "stream_mode": "ON_DEMAND"
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6NzIwMDAwMDAwMDAwMCwidXBkYXRlIjo3MjAwMDAwMDAwMDAwfSwic2NoZW1hX3ZlcnNpb24iOiIxIn0="
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "fx_trader",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-east-1:565692740138:function:fx-trader",
            "code_signing_config_arn": "",
            "dead_letter_config": [
              {
                "target_arn": "arn:aws:sqs:us-east-1:565692740138:fx-trader-dl-queue"
              }
            ],
            "description": "Sends the FX trade results to kinesis.",
            "environment": [
              {
                "variables": {
                  "FX_TRADE_STREAM": "fx-trader"
                }
              }
            ],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": null,
            "function_name": "fx-trader",
            "handler": "",
            "id": "fx-trader",
            "image_config": [],
            "image_uri": "565692740138.dkr.ecr.us-east-1.amazonaws.com/fx-trader:latest",
            "invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:565692740138:function:fx-trader/invocations",
            "kms_key_arn": "",
            "last_modified": "2023-08-03T14:09:12.009+0000",
            "layers": null,
            "memory_size": 1024,
            "package_type": "Image",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-east-1:565692740138:function:fx-trader:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-east-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-east-1:565692740138:function:fx-trader:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::565692740138:role/lambda-service-role/fx-trader-lambda-role",
            "runtime": "",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "52ee0c9d9056c82cabfa4d461750cee92511593b6cb0b91a6d587a23085a62c5",
            "source_code_size": 0,
            "tags": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            },
            "tags_all": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            },
            "timeout": 300,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "Active"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.fx_trader.aws_iam_role.fx_trader_lambda_role",
            "module.fx_trader.aws_kinesis_stream.fx_trader_stream",
            "module.fx_trader.aws_sqs_queue.fx_trader_dl_queue",
            "module.fx_trader.data.aws_caller_identity.current",
            "module.fx_trader.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_lambda_function_event_invoke_config",
      "name": "fx_trader_lambda_function_error_config",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "destination_config": [],
            "function_name": "fx-trader",
            "id": "fx-trader",
            "maximum_event_age_in_seconds": 0,
            "maximum_retry_attempts": 0,
            "qualifier": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.fx_trader.aws_iam_role.fx_trader_lambda_role",
            "module.fx_trader.aws_kinesis_stream.fx_trader_stream",
            "module.fx_trader.aws_lambda_function.fx_trader",
            "module.fx_trader.aws_sqs_queue.fx_trader_dl_queue",
            "module.fx_trader.data.aws_caller_identity.current",
            "module.fx_trader.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.fx_trader",
      "mode": "managed",
      "type": "aws_sqs_queue",
      "name": "fx_trader_dl_queue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:sqs:us-east-1:565692740138:fx-trader-dl-queue",
            "content_based_deduplication": false,
            "deduplication_scope": "",
            "delay_seconds": 90,
            "fifo_queue": false,
            "fifo_throughput_limit": "",
            "id": "https://sqs.us-east-1.amazonaws.com/565692740138/fx-trader-dl-queue",
            "kms_data_key_reuse_period_seconds": 300,
            "kms_master_key_id": "",
            "max_message_size": 2048,
            "message_retention_seconds": 86400,
            "name": "fx-trader-dl-queue",
            "name_prefix": "",
            "policy": "",
            "receive_wait_time_seconds": 10,
            "redrive_allow_policy": "",
            "redrive_policy": "",
            "sqs_managed_sse_enabled": true,
            "tags": null,
            "tags_all": {},
            "url": "https://sqs.us-east-1.amazonaws.com/565692740138/fx-trader-dl-queue",
            "visibility_timeout_seconds": 30
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "consumer",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "645593367411",
            "arn": "arn:aws:sts::645593367411:assumed-role/AWSCloudFormationStackSetExecutionRole/aws-go-sdk-1691071715241506000",
            "id": "645593367411",
            "user_id": "AROAZMUC5ANZVKDWVP3CX:aws-go-sdk-1691071715241506000"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "data",
      "type": "aws_region",
      "name": "consumer",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "glue_consumer_cwl_log_group",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:645593367411:log-group:/aws-glue/jobs/fx-trader-consumer-glue/",
            "id": "/aws-glue/jobs/fx-trader-consumer-glue/",
            "kms_key_id": "",
            "name": "/aws-glue/jobs/fx-trader-consumer-glue/",
            "name_prefix": "",
            "retention_in_days": 14,
            "skip_destroy": false,
            "tags": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            },
            "tags_all": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "fx-trader-consumer-job",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:645593367411:job/fx-trader-consumer-job-glue",
            "command": [
              {
                "name": "glueetl",
                "python_version": "3",
                "script_location": "s3://fx-trader-consumer-645593367411-us-east-1-bucket/fx_trader_consumer/scripts/fx_trader_glue_consumer_script.py"
              }
            ],
            "connections": null,
            "default_arguments": {
              "--TempDir": "s3://fx-trader-consumer-645593367411-us-east-1-bucket/fx_trader_consumer/temp/",
              "--continuous-log-logGroup": "/aws-glue/jobs/fx-trader-consumer-glue/",
              "--enable-continuous-cloudwatch-log": "true",
              "--enable-continuous-log-filter": "true",
              "--enable-job-insights": "true",
              "--enable-metrics": "",
              "--job-bookmark-option": "job-bookmark-enable",
              "--job-language": "python"
            },
            "description": "FX Trader Consumer glue job",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "3.0",
            "id": "fx-trader-consumer-job-glue",
            "max_capacity": 4,
            "max_retries": 0,
            "name": "fx-trader-consumer-job-glue",
            "non_overridable_arguments": null,
            "notification_property": [],
            "number_of_workers": 2,
            "role_arn": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "security_configuration": "",
            "tags": null,
            "tags_all": {},
            "timeout": 2880,
            "worker_type": "G.2X"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_consumer.aws_cloudwatch_log_group.glue_consumer_cwl_log_group",
            "module.glue_consumer.aws_s3_bucket.fx_trader_consumer_s3",
            "module.glue_consumer.aws_s3_object.glue_consumer_etl_script",
            "module.glue_consumer.data.aws_caller_identity.consumer",
            "module.glue_consumer.data.aws_region.consumer",
            "module.lakeformation_consumer.aws_iam_role.lf_consumer_role"
          ]
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "fx_trader_consumer_s3",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::fx-trader-consumer-645593367411-us-east-1-bucket",
            "bucket": "fx-trader-consumer-645593367411-us-east-1-bucket",
            "bucket_domain_name": "fx-trader-consumer-645593367411-us-east-1-bucket.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "fx-trader-consumer-645593367411-us-east-1-bucket.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "1edcde97cd1d6c8f2d41e9241710de0d23eeb8833bb2f5d344757dad2527d4cb",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "fx-trader-consumer-645593367411-us-east-1-bucket",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Environment": "Dev",
              "Name": "fx-trader-consumer"
            },
            "tags_all": {
              "Environment": "Dev",
              "Name": "fx-trader-consumer"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.glue_consumer.data.aws_caller_identity.consumer",
            "module.glue_consumer.data.aws_region.consumer"
          ]
        }
      ]
    },
    {
      "module": "module.glue_consumer",
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "glue_consumer_etl_script",
      "provider": "module.glue_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "bucket": "fx-trader-consumer-645593367411-us-east-1-bucket",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "import sys\nfrom awsglue.transforms import *\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\n\nargs = getResolvedOptions(sys.argv, [\"JOB_NAME\"])\nsc = SparkContext()\nglueContext = GlueContext(sc)\nspark = glueContext.spark_session\njob = Job(glueContext)\njob.init(args[\"JOB_NAME\"], args)\n\ntrades = glueContext.create_dynamic_frame.from_catalog(\n    database=\"fx_trader_link\",\n    table_name=\"trades\",\n    transformation_ctx=\"AWSGlueDataCatalog_node1684916913752\",\n)\n\ntrades.printSchema()\n\nglueContext.write_dynamic_frame.from_catalog(\n    frame=trades,\n    database = \"fx_trader_link\", \n    table_name = \"trades\", \n    transformation_ctx = \"datasource0\", \n)\n\n# S3bucket_node3_path = \"s3://fx-trader-565692740138-us-east-1-bucket/fx_trader/parquet/\"\n\n# sink = glueContext.getSink(\n#     connection_type=\"s3\", \n#     path=\"S3bucket_node3_path\",\n#     enableUpdateCatalog=True,\n#     partitionKeys=[\"ingest_year\", \"ingest_month\", \"ingest_day\", \"ingest_hour\"])\n# sink.setFormat(\"glueparquet\")\n# sink.setCatalogInfo(accountId=\"565692740138\", catalogDatabase=\"fx_trader\", catalogTableName=\"trades\")\n# sink.writeFrame(trades)\n\njob.commit()",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "binary/octet-stream",
            "etag": "d9d3a9fcbd851a1b1cbd9245d9f0efac",
            "force_destroy": false,
            "id": "fx_trader_consumer/scripts/fx_trader_glue_consumer_script.py",
            "key": "fx_trader_consumer/scripts/fx_trader_glue_consumer_script.py",
            "kms_key_id": null,
            "metadata": null,
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": null,
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_consumer.aws_s3_bucket.fx_trader_consumer_s3",
            "module.glue_consumer.data.aws_caller_identity.consumer",
            "module.glue_consumer.data.aws_region.consumer"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "data",
      "type": "aws_region",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "glue_cwl_log_group_glue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:565692740138:log-group:/aws-glue/jobs/fx-trader-glue/",
            "id": "/aws-glue/jobs/fx-trader-glue/",
            "kms_key_id": "",
            "name": "/aws-glue/jobs/fx-trader-glue/",
            "name_prefix": "",
            "retention_in_days": 14,
            "skip_destroy": false,
            "tags": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            },
            "tags_all": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "glue_cwl_log_group_spark",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-east-1:565692740138:log-group:/aws-glue/jobs/fx-trader-spark/",
            "id": "/aws-glue/jobs/fx-trader-spark/",
            "kms_key_id": "",
            "name": "/aws-glue/jobs/fx-trader-spark/",
            "name_prefix": "",
            "retention_in_days": 14,
            "skip_destroy": false,
            "tags": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            },
            "tags_all": {
              "Env": "POC",
              "Name": "fx-trader-demo"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_glue_catalog_database",
      "name": "aws_glue_fx_trader_database",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:565692740138:database/fx_trader",
            "catalog_id": "565692740138",
            "create_table_default_permission": [],
            "description": "",
            "id": "565692740138:fx_trader",
            "location_uri": "",
            "name": "fx_trader",
            "parameters": null,
            "tags": null,
            "tags_all": {},
            "target_database": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_glue_catalog_table",
      "name": "aws_glue_catalog_table",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:565692740138:table/fx_trader/trades",
            "catalog_id": "565692740138",
            "database_name": "fx_trader",
            "description": "",
            "id": "565692740138:fx_trader:trades",
            "name": "trades",
            "owner": "",
            "parameters": {
              "EXTERNAL": "TRUE",
              "classification": "parquet",
              "parquet.compression": "SNAPPY"
            },
            "partition_index": null,
            "partition_keys": [],
            "retention": 0,
            "storage_descriptor": [
              {
                "bucket_columns": null,
                "columns": [],
                "compressed": false,
                "input_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat",
                "location": "s3://fx-trader-565692740138-us-east-1-bucket/fx_trader/parquet/",
                "number_of_buckets": 0,
                "output_format": "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat",
                "parameters": null,
                "schema_reference": [],
                "ser_de_info": [
                  {
                    "name": "fx-trader",
                    "parameters": {
                      "serialization.format": "1"
                    },
                    "serialization_library": "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                  }
                ],
                "skewed_info": [],
                "sort_columns": [],
                "stored_as_sub_directories": false
              }
            ],
            "table_type": "EXTERNAL_TABLE",
            "target_table": [],
            "view_expanded_text": "",
            "view_original_text": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "fx-trader-glue",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:565692740138:job/fx-trader-stream-job-glue",
            "command": [
              {
                "name": "gluestreaming",
                "python_version": "3",
                "script_location": "s3://fx-trader-565692740138-us-east-1-bucket/scripts/fx_trader_glue_stream_script.py"
              }
            ],
            "connections": null,
            "default_arguments": {
              "--TempDir": "s3://fx-trader-565692740138-us-east-1-bucket/fx_trader/temp/",
              "--continuous-log-logGroup": "/aws-glue/jobs/fx-trader-glue/",
              "--enable-continuous-cloudwatch-log": "true",
              "--enable-continuous-log-filter": "true",
              "--enable-job-insights": "true",
              "--enable-metrics": "",
              "--job-language": "python"
            },
            "description": "FX Trade Results streaming glue job",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "3.0",
            "id": "fx-trader-stream-job-glue",
            "max_capacity": 4,
            "max_retries": 0,
            "name": "fx-trader-stream-job-glue",
            "non_overridable_arguments": null,
            "notification_property": [],
            "number_of_workers": 2,
            "role_arn": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "security_configuration": "",
            "tags": null,
            "tags_all": {},
            "timeout": 0,
            "worker_type": "G.2X"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_cloudwatch_log_group.glue_cwl_log_group_glue",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.aws_s3_object.glue_stream_script",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_glue_job",
      "name": "fx-trader-spark",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:565692740138:job/fx-trader-stream-job-spark",
            "command": [
              {
                "name": "gluestreaming",
                "python_version": "3",
                "script_location": "s3://fx-trader-565692740138-us-east-1-bucket/scripts/fx_trader_spark_script.py"
              }
            ],
            "connections": null,
            "default_arguments": {
              "--TempDir": "s3://fx-trader-565692740138-us-east-1-bucket/fx_trader/temp/",
              "--continuous-log-logGroup": "/aws-glue/jobs/fx-trader-spark/",
              "--enable-continuous-cloudwatch-log": "true",
              "--enable-continuous-log-filter": "true",
              "--enable-job-insights": "true",
              "--enable-metrics": "",
              "--job-language": "python"
            },
            "description": "FX Trade Results streaming glue job using spark connector",
            "execution_class": "",
            "execution_property": [
              {
                "max_concurrent_runs": 1
              }
            ],
            "glue_version": "3.0",
            "id": "fx-trader-stream-job-spark",
            "max_capacity": 2,
            "max_retries": 0,
            "name": "fx-trader-stream-job-spark",
            "non_overridable_arguments": null,
            "notification_property": [],
            "number_of_workers": 2,
            "role_arn": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "security_configuration": "",
            "tags": null,
            "tags_all": {},
            "timeout": 0,
            "worker_type": "G.1X"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_cloudwatch_log_group.glue_cwl_log_group_spark",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.aws_s3_object.glue_job_spark_script",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_glue_resource_policy",
      "name": "glue_resource_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "enable_hybrid": "TRUE",
            "id": "us-east-1",
            "policy": "{\"Statement\":[{\"Action\":\"glue:ShareResource\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"ram.amazonaws.com\"},\"Resource\":[\"arn:aws:glue:us-east-1:565692740138:table/*/*\",\"arn:aws:glue:us-east-1:565692740138:database/*\",\"arn:aws:glue:us-east-1:565692740138:catalog\"]},{\"Action\":\"glue:*\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::645593367411:root\"},\"Resource\":[\"arn:aws:glue:us-east-1:565692740138:table/*/*\",\"arn:aws:glue:us-east-1:565692740138:database/*\",\"arn:aws:glue:us-east-1:565692740138:catalog\"]}],\"Version\":\"2012-10-17\"}"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "fx_trader_s3",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
            "bucket": "fx-trader-565692740138-us-east-1-bucket",
            "bucket_domain_name": "fx-trader-565692740138-us-east-1-bucket.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "fx-trader-565692740138-us-east-1-bucket.s3.us-east-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "a62048f509372d90dcae60b3140619ec833607db1ba14f5ca9afc0396389fded",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z3AQBSTGFYJSTF",
            "id": "fx-trader-565692740138-us-east-1-bucket",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-east-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Environment": "Dev",
              "Name": "fx-trader"
            },
            "tags_all": {
              "Environment": "Dev",
              "Name": "fx-trader"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "glue_job_spark_script",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "bucket": "fx-trader-565692740138-us-east-1-bucket",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "import sys\nfrom awsglue.transforms import *\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\n \nsc = SparkContext.getOrCreate()\nglueContext = GlueContext(sc)\nspark = glueContext.spark_session\njob = Job(glueContext)\nargs = getResolvedOptions(sys.argv, [\"JOB_NAME\"])\njob.init(args[\"JOB_NAME\"], args)\n\nlogger = glueContext.get_logger()\nlogger.info(\"info logger initiated\")\nlogger.warn(\"warn logger initiated\")\nlogger.error(\"error logger initiated\")\n \nkdf = spark \\\n    .readStream \\\n    .format('kinesis') \\\n    .option('streamName', 'fx-trader') \\\n    .option('endpointUrl', 'https://kinesis.us-east-1.amazonaws.com')\\\n    .option('region', 'us-east-1') \\\n    .option('startingposition', 'LATEST')\\\n    .load()\n \nschema = kdf.printSchema()\nlogger.info(f\"Dataframe Schema: {schema}\")\n\ndef foreach_batch_function(df, epoch_id):\n    logger.info(f\"Dataframe: {df}\")\n    logger.info(f\"Dataframe tyoe: {type(df)}\")\n\n    #df.show(vertical=True, truncate=False)\n    #df.select('sequenceNumber').show(truncate=False)\n    #seqnum_rows = df.select('sequenceNumber').collect()\n    #data_rows = df.select('data').collect()\n\n    #for i in seqnum_rows:\n    #    print(i)\n        \n    #for i in data_rows:\n    #    print(i)\n    \n    logger.info(f\"FXTRADE logger: Schema {schema}\")\n    data_collect = df.collect()\n    for row in data_collect:\n\n        logger.info(f\"\"\"FXTRADER logger: Seqnum: {row[\"sequenceNumber\"]}, TimeStamp: {row[\"approximateArrivalTimestamp\"]} \"\"\")\n        logger.info(f\"\"\"FXTRADER logger: {row[\"data\"]}\"\"\")\n        \nkdf\\\n    .writeStream\\\n    .option(\"checkpointLocation\", args[\"TempDir\"] + \"/checkpoint/spark\")\\\n    .option(\"truncate\", False)\\\n    .foreachBatch(foreach_batch_function)\\\n    .start().awaitTermination() ",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "binary/octet-stream",
            "etag": "65a7b85e518fd63cff338cb0ba033cd1",
            "force_destroy": false,
            "id": "scripts/fx_trader_spark_script.py",
            "key": "scripts/fx_trader_spark_script.py",
            "kms_key_id": null,
            "metadata": null,
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": null,
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.glue_producer",
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "glue_stream_script",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "bucket": "fx-trader-565692740138-us-east-1-bucket",
            "bucket_key_enabled": false,
            "cache_control": "",
            "content": "import sys\nfrom awsglue.transforms import *\nfrom awsglue.utils import getResolvedOptions\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.job import Job\n\nfrom pyspark.sql import DataFrame, Row\nimport datetime\nfrom awsglue import DynamicFrame\n\nargs = getResolvedOptions(sys.argv, [\"JOB_NAME\"])\nsc = SparkContext()\nglueContext = GlueContext(sc)\nspark = glueContext.spark_session\njob = Job(glueContext)\njob.init(args[\"JOB_NAME\"], args)\n\nlogger = glueContext.get_logger()\nlogger.info(\"info logger initiated\")\nlogger.warn(\"warn logger initiated\")\nlogger.error(\"error logger initiated\")\n\n# Script generated for node Kinesis Stream\ndataframe_KinesisStream_node1 = glueContext.create_data_frame.from_options(\n    connection_type=\"kinesis\",\n    connection_options={\n        \"typeOfData\": \"kinesis\",\n        \"streamARN\": \"arn:aws:kinesis:us-east-1:565692740138:stream/fx-trader\",\n        \"classification\": \"json\",\n        \"startingPosition\": \"earliest\",\n        \"inferSchema\": \"true\",\n    },\n    transformation_ctx=\"dataframe_KinesisStream_node1\",\n)\n\nredshift_conn_options = {\n    \"dbtable\": \"trades\",\n    \"database\": \"fx_trader_results\",\n    \"aws_iam_role\": \"arn:aws:iam::565692740138:role/RedshiftAdminRole\"\n}\n\ndef redshift_function(KinesisDynamicFrame):\n    print(\"-----schema------\")\n    print(KinesisDynamicFrame.printSchema())\n    d = KinesisDynamicFrame.toDF()\n    d.show()\n    logger.info(f\"FXTRADER logger: KinesisDynamicFrame type {type(KinesisDynamicFrame)}\")\n    logger.info(f\"FXTRADER logger: Returning number of rows{KinesisDynamicFrame.count()}\")\n    logger.info(f\"FXTRADER logger: Current schema {KinesisDynamicFrame.printSchema()}\")\n    logger.info(f\"FXTRADER logger: Current dataframe: {d.show()}\")\n    logger.info(f\"FXTRADER logger: Writing dynamic dataframe to Redshift\")\n    KinesisDynamicFrame = KinesisDynamicFrame.drop_fields(paths=[\"trade_code_dict\",\"stock_exchange\"])\n\n    datasink = glueContext.write_dynamic_frame.from_jdbc_conf(\n        frame=KinesisDynamicFrame,\n        redshift_tmp_dir=args[\"TempDir\"] + \"redshift/fx_trader/\",\n        catalog_connection=\"fx_trader\",\n        transformation_ctx=\"redshift_ctx\",\n        connection_options=redshift_conn_options,\n    )\n    logger.info(f\"FXTRADER logger: Written Dynamic Dataframe to Redshift\")\n\ndef processBatch(data_frame, batchId):\n    if data_frame.count() \u003e 0:\n        KinesisDynamicFrame = DynamicFrame.fromDF(\n            glueContext.add_ingestion_time_columns(data_frame, \"hour\"),\n            glueContext,\n            \"from_data_frame\",\n        )\n        # Write Dynamic Dataframe to Redshift\n        ##### DISABLING REDSHIFT FUNCTIONALITY ####\n        # redshift_function(KinesisDynamicFrame)\n        # Script generated for node S3 bucket\n        S3bucket_node3_path = \"s3://fx-trader-565692740138-us-east-1-bucket/fx_trader/parquet/\"\n        S3bucket_node3 = glueContext.getSink(\n            path=S3bucket_node3_path,\n            connection_type=\"s3\",\n            updateBehavior=\"UPDATE_IN_DATABASE\",\n            partitionKeys=[\"ingest_year\", \"ingest_month\", \"ingest_day\", \"ingest_hour\"],\n            enableUpdateCatalog=True,\n            compression=\"snappy\",\n            transformation_ctx=\"S3bucket_node3\",\n        )\n        S3bucket_node3.setCatalogInfo(\n            catalogDatabase=\"fx_trader\", catalogTableName=\"trades\"\n        )\n        S3bucket_node3.setFormat(\"glueparquet\")\n        S3bucket_node3.writeFrame(KinesisDynamicFrame)\n\nglueContext.forEachBatch(\n    frame=dataframe_KinesisStream_node1,\n    batch_function=processBatch,\n    options={\n        \"windowSize\": \"10 seconds\",\n        \"checkpointLocation\": args[\"TempDir\"] + \"/checkpoint/glue/\",\n    },\n)\njob.commit()",
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "binary/octet-stream",
            "etag": "8be08060171ec5743fdaca3f3372c1f5",
            "force_destroy": false,
            "id": "scripts/fx_trader_glue_stream_script.py",
            "key": "scripts/fx_trader_glue_stream_script.py",
            "kms_key_id": null,
            "metadata": null,
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "server_side_encryption": "AES256",
            "source": null,
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": null,
            "tags_all": {},
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "consumer",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "645593367411",
            "arn": "arn:aws:sts::645593367411:assumed-role/AWSCloudFormationStackSetExecutionRole/aws-go-sdk-1691071715246148000",
            "id": "645593367411",
            "user_id": "AROAZMUC5ANZVKDWVP3CX:aws-go-sdk-1691071715246148000"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "data",
      "type": "aws_region",
      "name": "consumer",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_glue_catalog_database",
      "name": "aws_glue_fx_trader_database",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:glue:us-east-1:645593367411:database/fx_trader_link",
            "catalog_id": "645593367411",
            "create_table_default_permission": [],
            "description": "",
            "id": "645593367411:fx_trader_link",
            "location_uri": "",
            "name": "fx_trader_link",
            "parameters": null,
            "tags": null,
            "tags_all": {},
            "target_database": [
              {
                "catalog_id": "565692740138",
                "database_name": "fx_trader"
              }
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.data.aws_caller_identity.consumer",
            "module.lakeformation_consumer.data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "lf_consumer_policy",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::645593367411:policy/AWSLakeFormationConsumerIamPolicy",
            "description": "IAM AWS Lake Formation Consumer IAM Policy.",
            "id": "arn:aws:iam::645593367411:policy/AWSLakeFormationConsumerIamPolicy",
            "name": "AWSLakeFormationConsumerIamPolicy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"glue:GetTable\",\"glue:GetTables\",\"glue:GetPartition\",\"glue:GetPartitions\",\"glue:BatchGetPartition\",\"glue:GetDatabase\",\"glue:GetDatabases\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:glue:us-east-1:565692740138:table/fx_trades/trades\",\"arn:aws:glue:us-east-1:645593367411:table/fx_trades_link/trades\",\"arn:aws:glue:us-east-1:565692740138:database/fx_trader\",\"arn:aws:glue:us-east-1:645593367411:database/fx_trader_link\",\"arn:aws:glue:us-east-1:645593367411:catalog\",\"arn:aws:glue:us-east-1:565692740138:catalog\"]},{\"Action\":[\"lakeformation:GetDataAccess\"],\"Condition\":{\"StringEquals\":{\"lakeformation:GlueARN\":\"arn:aws:glue:us-east-1:645593367411:table/*\"}},\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:lakeformation:us-east-1:645593367411:catalog:565692740138\"]},{\"Action\":[\"s3:ListBucket\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::fx-trader-consumer-645593367411-us-east-1-bucket\"]},{\"Action\":[\"s3:DeleteObject\",\"s3:GetObject\",\"s3:PutObject\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:s3:::fx-trader-consumer-645593367411-us-east-1-bucket/fx_trader_consumer/*\"]},{\"Action\":[\"logs:CreateLogGroup\",\"logs:CreateLogStream\",\"logs:PutLogEvents\",\"logs:DescribeLogStreams\"],\"Effect\":\"Allow\",\"Resource\":[\"arn:aws:logs:*:*:*\"]}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPAZMUC5ANZ7NF2IDWLE",
            "tags": null,
            "tags_all": {}
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_consumer.aws_s3_bucket.fx_trader_consumer_s3",
            "module.glue_consumer.data.aws_caller_identity.consumer",
            "module.glue_consumer.data.aws_region.consumer",
            "module.glue_producer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.glue_producer.aws_glue_catalog_table.aws_glue_catalog_table",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_consumer.data.aws_caller_identity.consumer",
            "module.lakeformation_consumer.data.aws_caller_identity.current",
            "module.lakeformation_consumer.data.aws_region.consumer"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_iam_policy_attachment",
      "name": "lf_policy_attachment_1",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "groups": null,
            "id": "lf-consumer-policy-attachment-1",
            "name": "lf-consumer-policy-attachment-1",
            "policy_arn": "arn:aws:iam::645593367411:policy/AWSLakeFormationConsumerIamPolicy",
            "roles": [
              "AWSLakeFormationConsumerIamRole"
            ],
            "users": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_consumer.aws_s3_bucket.fx_trader_consumer_s3",
            "module.glue_consumer.data.aws_caller_identity.consumer",
            "module.glue_consumer.data.aws_region.consumer",
            "module.glue_producer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.glue_producer.aws_glue_catalog_table.aws_glue_catalog_table",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_consumer.aws_iam_policy.lf_consumer_policy",
            "module.lakeformation_consumer.aws_iam_role.lf_consumer_role",
            "module.lakeformation_consumer.data.aws_caller_identity.consumer",
            "module.lakeformation_consumer.data.aws_caller_identity.current",
            "module.lakeformation_consumer.data.aws_region.consumer"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_iam_policy_attachment",
      "name": "lf_policy_attachment_2",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "groups": null,
            "id": "lf-consumer-policy-attachment-2",
            "name": "lf-consumer-policy-attachment-2",
            "policy_arn": "arn:aws:iam::aws:policy/AWSLakeFormationDataAdmin",
            "roles": [
              "AWSLakeFormationConsumerIamRole"
            ],
            "users": null
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_iam_role.lf_consumer_role"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lf_consumer_role",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"glue.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2023-08-03T14:08:41Z",
            "description": "IAM AWS Lake Formation Consumer IAM role",
            "force_detach_policies": false,
            "id": "AWSLakeFormationConsumerIamRole",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "AWSLakeFormationConsumerIamRole",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": null,
            "role_last_used": [
              {
                "last_used_date": "",
                "region": ""
              }
            ],
            "tags": null,
            "tags_all": {},
            "unique_id": "AROAZMUC5ANZSHQ5KZ4AV"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_lf_tag",
      "name": "fx_trader_consumer_ro_tag",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": "645593367411",
            "id": "645593367411:FX_TRADER_RO_ACCESS",
            "key": "FX_TRADER_RO_ACCESS",
            "values": [
              "Trades_Readonly"
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_lf_tag",
      "name": "fx_trader_consumer_rw_tag",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": "645593367411",
            "id": "645593367411:FX_TRADER_RW_ACCESS",
            "key": "FX_TRADER_RW_ACCESS",
            "values": [
              "Trades_Write"
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_consumer_ro_database",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "1277769531",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "645593367411",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "DESCRIBE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_ro_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_consumer_ro_table",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "4106814473",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "645593367411",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_iam_role.lf_consumer_role",
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_ro_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_consumer_rw_database",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "147444061",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "645593367411",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Write"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "ALTER",
              "CREATE_TABLE",
              "DROP"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_rw_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_consumer_rw_table",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "2589509584",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "645593367411",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Write"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "ALTER",
              "INSERT",
              "SELECT"
            ],
            "permissions_with_grant_option": [
              "ALL",
              "ALTER",
              "DELETE",
              "DESCRIBE",
              "DROP",
              "INSERT",
              "SELECT"
            ],
            "principal": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_rw_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "1461421722",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "645593367411",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Write"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "ALTER",
              "INSERT",
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_rw_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_resource_lf_tags",
      "name": "fx_trader_database_ro_tags",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "database": [
              {
                "catalog_id": "",
                "name": "fx_trader_link"
              }
            ],
            "id": "94290283",
            "lf_tag": [
              {
                "catalog_id": "645593367411",
                "key": "FX_TRADER_RW_ACCESS",
                "value": "Trades_Write"
              }
            ],
            "table": null,
            "table_with_columns": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.lakeformation_consumer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_ro_tag",
            "module.lakeformation_consumer.data.aws_caller_identity.consumer",
            "module.lakeformation_consumer.data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_consumer",
      "mode": "managed",
      "type": "aws_lakeformation_resource_lf_tags",
      "name": "fx_trader_database_rw_tags",
      "provider": "module.lakeformation_consumer.provider[\"registry.terraform.io/hashicorp/aws\"].consumer",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "database": [
              {
                "catalog_id": "",
                "name": "fx_trader_link"
              }
            ],
            "id": "3143499767",
            "lf_tag": [
              {
                "catalog_id": "645593367411",
                "key": "FX_TRADER_RW_ACCESS",
                "value": "Trades_Write"
              }
            ],
            "table": null,
            "table_with_columns": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.lakeformation_consumer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.lakeformation_consumer.aws_lakeformation_lf_tag.fx_trader_consumer_rw_tag",
            "module.lakeformation_consumer.data.aws_caller_identity.consumer",
            "module.lakeformation_consumer.data.aws_caller_identity.current"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "565692740138",
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "565692740138",
            "user_id": "AIDAIQ4MX5YMXFJPWR64W"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "data",
      "type": "aws_iam_user",
      "name": "lakeformation_admin",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::565692740138:user/oli",
            "id": "AIDAIQ4MX5YMXFJPWR64W",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "user_id": "AIDAIQ4MX5YMXFJPWR64W",
            "user_name": "oli"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "data",
      "type": "aws_region",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "US East (N. Virginia)",
            "endpoint": "ec2.us-east-1.amazonaws.com",
            "id": "us-east-1",
            "name": "us-east-1"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_lf_tag",
      "name": "fx_trader_ro_tag",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": "565692740138",
            "id": "565692740138:FX_TRADER_RO_ACCESS",
            "key": "FX_TRADER_RO_ACCESS",
            "values": [
              "Trades_Readonly"
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_lf_tag",
      "name": "fx_trader_rw_tag",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": "565692740138",
            "id": "565692740138:FX_TRADER_RW_ACCESS",
            "key": "FX_TRADER_RW_ACCESS",
            "values": [
              "Trades_Full"
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_lf_tag",
      "name": "lf_admin_tag",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": "565692740138",
            "id": "565692740138:LF_ADMIN_ACCESS",
            "key": "LF_ADMIN_ACCESS",
            "values": [
              "Admin",
              "Share",
              "User"
            ]
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_producer_ro_database",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "3780172007",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "DESCRIBE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "1277769531",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "DESCRIBE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_producer_ro_table",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "3655684334",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "4106814473",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RO_ACCESS",
                    "values": [
                      "Trades_Readonly"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_producer_rw_database",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "2682957547",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "ALTER",
              "CREATE_TABLE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "3033527435",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "ALTER",
              "CREATE_TABLE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "2108083885",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "DATABASE"
              }
            ],
            "permissions": [
              "ALTER",
              "CREATE_TABLE"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "lf_producer_rw_table",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "3256796205",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "ALTER",
              "INSERT",
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "932923956",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "ALTER",
              "INSERT",
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [],
            "database": [],
            "id": "2749141953",
            "lf_tag": [],
            "lf_tag_policy": [
              {
                "catalog_id": "565692740138",
                "expression": [
                  {
                    "key": "FX_TRADER_RW_ACCESS",
                    "values": [
                      "Trades_Full"
                    ]
                  }
                ],
                "resource_type": "TABLE"
              }
            ],
            "permissions": [
              "ALTER",
              "INSERT",
              "SELECT"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_permissions",
      "name": "s3_bucket_data_location",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "index_key": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [
              {
                "arn": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
                "catalog_id": "565692740138"
              }
            ],
            "database": [],
            "id": "87414421",
            "lf_tag": [],
            "lf_tag_policy": [],
            "permissions": [
              "DATA_LOCATION_ACCESS"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::565692740138:role/service-role/AWSGlueServiceRole-lab-01",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_producer.aws_lakeformation_resource.fx_trader_s3_bucket"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [
              {
                "arn": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
                "catalog_id": "565692740138"
              }
            ],
            "database": [],
            "id": "3874671866",
            "lf_tag": [],
            "lf_tag_policy": [],
            "permissions": [
              "DATA_LOCATION_ACCESS"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSCloudFormationStackSetExecutionRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_producer.aws_lakeformation_resource.fx_trader_s3_bucket"
          ]
        },
        {
          "index_key": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "catalog_resource": false,
            "data_location": [
              {
                "arn": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
                "catalog_id": "565692740138"
              }
            ],
            "database": [],
            "id": "1326161681",
            "lf_tag": [],
            "lf_tag_policy": [],
            "permissions": [
              "DATA_LOCATION_ACCESS"
            ],
            "permissions_with_grant_option": [],
            "principal": "arn:aws:iam::645593367411:role/AWSLakeFormationConsumerIamRole",
            "table": [],
            "table_with_columns": []
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_producer.aws_lakeformation_resource.fx_trader_s3_bucket"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_resource",
      "name": "fx_trader_s3_bucket",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
            "id": "arn:aws:s3:::fx-trader-565692740138-us-east-1-bucket",
            "last_modified": null,
            "role_arn": "arn:aws:iam::565692740138:role/aws-service-role/lakeformation.amazonaws.com/AWSServiceRoleForLakeFormationDataAccess"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_resource_lf_tags",
      "name": "fx_trader_producer_database",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "database": [
              {
                "catalog_id": "",
                "name": "fx_trader"
              }
            ],
            "id": "980898191",
            "lf_tag": [
              {
                "catalog_id": "565692740138",
                "key": "FX_TRADER_RO_ACCESS",
                "value": "Trades_Readonly"
              },
              {
                "catalog_id": "565692740138",
                "key": "FX_TRADER_RW_ACCESS",
                "value": "Trades_Full"
              },
              {
                "catalog_id": "565692740138",
                "key": "LF_ADMIN_ACCESS",
                "value": "Admin"
              }
            ],
            "table": null,
            "table_with_columns": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.glue_producer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag",
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag",
            "module.lakeformation_producer.aws_lakeformation_lf_tag.lf_admin_tag"
          ]
        }
      ]
    },
    {
      "module": "module.lakeformation_producer",
      "mode": "managed",
      "type": "aws_lakeformation_resource_lf_tags",
      "name": "fx_trader_producer_table",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "catalog_id": null,
            "database": null,
            "id": "2981751323",
            "lf_tag": [
              {
                "catalog_id": "565692740138",
                "key": "FX_TRADER_RO_ACCESS",
                "value": "Trades_Readonly"
              },
              {
                "catalog_id": "565692740138",
                "key": "FX_TRADER_RW_ACCESS",
                "value": "Trades_Full"
              }
            ],
            "table": [
              {
                "catalog_id": "",
                "database_name": "fx_trader",
                "name": "trades",
                "wildcard": false
              }
            ],
            "table_with_columns": null,
            "timeouts": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDB9fQ==",
          "dependencies": [
            "module.glue_producer.aws_glue_catalog_database.aws_glue_fx_trader_database",
            "module.glue_producer.aws_glue_catalog_table.aws_glue_catalog_table",
            "module.glue_producer.aws_s3_bucket.fx_trader_s3",
            "module.glue_producer.data.aws_caller_identity.current",
            "module.glue_producer.data.aws_region.current",
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_ro_tag",
            "module.lakeformation_producer.aws_lakeformation_lf_tag.fx_trader_rw_tag"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
